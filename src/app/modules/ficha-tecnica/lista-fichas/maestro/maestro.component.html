<div class="d-sm-flex align-items-center justify-content-between mb-3">
  <h1  class="h5 mb-0 text-gray-800">Registar Ficha de Mantenimiento</h1>
</div>
<div class="row">
  <div class="col-xl-12 mb-4">

<form autocomplete="off" #orderF="ngForm" *ngIf="service.formData" >
  <mat-card>

    <div class="form-row">
      <mat-form-field class="col-md-6">
        <mat-label>Cliente</mat-label>
        <input matInput placeholder="Ej. Carlo Cerezo"
         name="fk_cliente" #fk_cliente="ngModel" [(ngModel)]="service.formData.fk_cliente"
               required>
      </mat-form-field>
      <mat-form-field class="col-md-6">
        <mat-label>Tipo Cliente</mat-label>
        <input matInput placeholder="Ej. domicilio o empresa"
        name="tipo_cliente" #tipo_cliente="ngModel" [(ngModel)]="service.formData.tipo_cliente">
      </mat-form-field>
    </div>


    <div class="form-row">
      <mat-form-field class="col-md-6">
        <mat-label>CÃ³digo</mat-label>
        <input matInput placeholder="Ej. #001234"  name="codigo" #codigo="ngModel" [(ngModel)]="service.formData.codigo" required>
      </mat-form-field>
      <mat-form-field class="col-md-6">
        <mat-label>TDS</mat-label>
        <input matInput placeholder="Ej. 10"  name="tds" #tds="ngModel" [(ngModel)]="service.formData.tds" >
      </mat-form-field>
    </div>


    <div class="form-row">
      <mat-form-field class="col-md-6">
        <mat-label>PPM</mat-label>
        <input matInput placeholder="Ej. 34"  name="ppm" #ppm="ngModel" [(ngModel)]="service.formData.ppm"  required>
      </mat-form-field>
      <mat-form-field class="col-md-6">
        <mat-label>Visitas</mat-label>
        <input matInput placeholder="Ej. 3 meses"  name="visitas" #visitas="ngModel" [(ngModel)]="service.formData.visitas" >
      </mat-form-field>
    </div>


    <div class="form-row">
      <mat-form-field class="col-md-6">
        <mat-label>Fecha Comprado</mat-label>
        <input matInput placeholder="Ej. 15-03-2015" name="fecha_comprado" #fecha_comprado="ngModel" [(ngModel)]="service.formData.fecha_comprado" required>
      </mat-form-field>
    </div>

  </mat-card>

  <div class="table-responsive">
  <!-- Table Ficha Tecnica Detalles  -->
  <table class="table table-borderless">
    <thead class="thead-light">
    <th>Fact.</th>
    <th>Fecha Mant</th>
    <th>Recibo</th>
    <th>Ficha Tecnica</th>
    <th>Descripcion</th>
    <th>Pers. Recep</th>
    <th>Firma</th>
    <th>Ced. Receptor</th>
    <th>Pers. Mant</th>
    <th>Ced. Pers Mant</th>
    <th colspan="3">
      <a class="btn btn-sm btn-success text-white" (click)="AddOrEditFichaTecnicaDetalle(0, service.formData.id)"><i class="fa fa-plus"></i>Agregar Detalle</a>
    </th>
    </thead>
    <tbody>
    <tr *ngIf="service.fichaTecnicaItems?.length==0"
        [class.text-danger]="!isValid && service.fichaTecnicaItems.length==0"
    >
      <td class="font-italic text-center" colspan="10">
        Ningun detalle se ha seleccionado para esta ficha tecnica
      </td>
    </tr>

    <tr *ngFor="let item of service.fichaTecnicaItems; let i= index">
      <td>{{item.factura}}</td>
      <td>{{item.fecha_mantenimiento}}</td>
      <td>{{item.recibo}}</td>
      <td>{{item.ficha_tecnica}}</td>
      <td>{{item.descripcion}}</td>
      <td>{{item.persona_recepta}}</td>
      <td>{{item.firma_url}}</td>
      <td>{{item.cedula_receptor}}</td>
      <td>{{item.persona_dio_mantenimiento}}</td>
      <td>{{item.cedula_dio_mantenimiento}}</td>
      <td colspan="3">
        <a class="btn btn-sm btn-info text-white" data-toggle="tooltip" data-placement="top" title="Editar" (click)="AddOrEditFichaTecnicaDetalle(i,service.formData.id)">
          <i class="fa fa-pencil"></i></a>

        <a class="btn btn-sm btn-info text-white ml-1" data-toggle="tooltip" data-placement="bottom" title="Agregar Accesorio" (click)="AddOrEditAccesorios(i,service.formData.id)">
          <i class="fa fa-cog"></i></a>
          
        <a class="btn btn-sm btn-info text-white ml-1"  data-toggle="tooltip" data-placement="top" title="Agregar Filtracion" (click)="AddOrEditFiltraciones(i,service.formData.id)">
          <i class="fas fa-cloud-rain"></i> </a>          

      </td>
    </tr>
    </tbody>


  </table>
  </div>
  <!-- Fin de la tabla -->

  <div class="form-group">
    <button type="submit" class="btn btn-dark"><i class="fa fa-database"></i> Submit</button>
    <a class="btn btn-outline-dark ml-1" routerLink="/ficha-tecnica/fichas-tecnicas" ><i class="fa fa-table"></i> Ver Fichas Tecnicas</a>
  </div>
</form>
  </div>
</div>
